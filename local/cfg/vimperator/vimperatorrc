" LOCALDIR/cfg/vimperator/vimperatorrc

" TODO
" * Provide some kind of way to open the uBlock panel via a keybind, this will
"   likely need a javascript function.
" * Think about better configuration layout, splitting up this file, etc.
" * Preserve hint narrowing in ;F mode.
"   https://github.com/vimperator/vimperator-labs/issues/332

set runtimepath=$HOME/local/cfg/vimperator

source $LOCALDIR/cfg/vimperator/plugins/launchv.js
source $LOCALDIR/cfg/vimperator/plugins/toggle.js

" Style.
source $HOME/local/cfg/vimperator/chrome.css
colorscheme hints

set hlsearch
set tabnumbers
set autocomplete
set noscrollbars
set focuscontent
set defsearch=ddg
set gui=none,tabs
set wildmode=list:longest,full

" Vimperator doesn't correctly handle non-hacked -e terminals.
set editor=termite-vi

" Speed up scrolling.
noremap h 5h
noremap j 5j
noremap k 5k
noremap l 5l

" Tab control.
nmap <A-h> :tabprev<CR>
nmap <A-l> :tabnext<CR>
nmap <A-S-h> :tabmove -1<CR>
nmap <A-S-l> :tabmove +1<CR>

" Easily show downloads
nmap <S-d> :tab downloads<CR>

nmap <A-x> :togglejs<CR>

" Stop <C-j> and <C-k> doing whatever it does.
nmap <C-j> <nop>
nmap <C-k> <nop>

nmap <S-u> :launchv<CR>

nmap <C-l> :nohl<CR>

" For some reason the built-in behaviour of C-c is no longer functional.
" https://github.com/vimperator/vimperator-labs/issues/325
nmap <C-c> :stop<CR>

" Fix for uBlock panel menu popup.
" https://github.com/gorhill/uBlock/issues/112
set! extensions.ublock0.forceLegacyToolbarButton=true

" Preferences, mostly added for reproducability from a single configuration.
set! font.name.monospace.x-western=Inconsolatazi4
set! font.name.serif.x-western=Georgia
set! font.minimum-size.x-western=16
set! browser.search.defaultenginename=DDG Bangs
set! intl.charset.fallback.override=unicode
set! extensions.checkCompatibility=false
set! media.peerconnection.enabled=false
set! middlemouse.contentLoadURL=false
set! network.cookie.cookieBehavior=1
set! plugins.click_to_play=true
set! general.smoothScroll=false
set! plugin.default.state=1

" Sigh.
set! xpinstall.signatures.required=false

" Popups are back, after all those years trying to get rid of them, now the
" browsers do it themselves.
set! reader.parse-on-load.enabled=false

" Disable all kinds of additional crap that leaks private data.
" Straight from the school of enumerating badness.
set! browser.safebrowsing.downloads.enabled=false
set! browser.safebrowsing.malware.enabled=false
set! browser.safebrowsing.enabled=false

set! privacy.trackingprotection.enabled=true
set! browser.search.suggest.enabled=false
set! network.http.sendRefererHeader=0
set! network.prefetch-next=false
set! browser.pocket.enabled=false
set! geo.enabled=false

" Firefox can honestly go to hell.
set! datareporting.healthreport.service.enabled=false
set! datareporting.healthreport.uploadEnabled=false
set! toolkit.telemetry.enabled=false
set! browser.selfsupport.url=""
set! browser.readinglist.enabled=false
set! browser.readinglist.sidebarEverOpened=false

" Fuck EME and the scum suckers that supported getting this trash into the
" standard.
set! media.gmp-eme-adobe.enabled=false
set! media.eme.enabled=false

" Disable "Firefox Hello" garbage.
set! loop.enabled=false

" Disable WebRTC crap.
set! media.peerconnection.enabled=false

" Globally disable javascript.
set! javascript.enabled=false

" Require websites preform safe ssl negotiation.
set! security.ssl.treat_unsafe_negotiation_as_broken=true
set! security.ssl.require_safe_negotiation=true

" Try in futility to disable HTML5 video/audio. 
" Note: Disabling autoplay doesn't actually prevent autoplay because that would
"       be too simple. <https://bugzil.la/659285>
set! media.autoplay.enabled=false
set! media.gstreamer.enabled=false
set! media.webm.enabled=false
set! media.opus.enabled=false
set! media.wave.enabled=false
set! media.ogg.enabled=false
